<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generatore Martingala</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 10px;
      background: #f9f9f9;
    }
    input, select, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
    }
    textarea {
      width: 100%;
      height: 300px;
      margin-top: 20px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h2>Generatore Sequenza Martingala</h2>
  <label>Livello di rischio:</label>
  <select id="livello">
    <option value="basso">Basso (rischio minimo)</option>
    <option value="medio">Medio</option>
    <option value="alto">Alto (martingala classica)</option>
  </select>

  <label>Puntata minima (€):</label>
  <input type="number" id="min" step="0.1" value="0.5" />

  <label>Puntata massima (€):</label>
  <input type="number" id="max" step="0.1" value="20" />

  <label>Massimo da scommettere (€):</label>
  <input type="number" id="cap" step="0.1" value="50" />

  <label>Payout (es. 3 per le dozzine):</label>
  <input type="number" id="payout" step="0.1" value="3" />

  <button onclick="generaSequenza()">Genera Sequenza</button>

  <textarea id="output" readonly></textarea>

  <script>
    function generaSequenza() {
      const livello = document.getElementById("livello").value;
      let puntata = parseFloat(document.getElementById("min").value);
      const puntataMax = parseFloat(document.getElementById("max").value);
      const capitale = parseFloat(document.getElementById("cap").value);
      const payout = parseFloat(document.getElementById("payout").value);

      let risultato = "";
      let totale = 0;
      let step = 1;
      let count = 0;

      while (totale + puntata <= capitale && puntata <= puntataMax) {
        let profitto = +(puntata * payout - (totale + puntata)).toFixed(2);
        risultato += `Step ${step}: Punta ${puntata.toFixed(2)}€ | Totale rischiato: ${(totale + puntata).toFixed(2)}€ | Profitto netto se vinci: ${profitto.toFixed(2)}€\n`;
        totale += puntata;
        step++;

        if (livello === "alto") {
          puntata *= 2;
        } else if (livello === "medio") {
          puntata = puntata * 1.5 >= puntata + 0.1 ? puntata * 1.5 : puntata + 0.1;
        } else if (livello === "basso") {
          if (count < 1) {
            count++;
            continue;
          }
          // aumenta solo quando necessario per mantenere profitto > 1
          do {
            puntata = +(puntata + 0.1).toFixed(2);
            profitto = +(puntata * payout - (totale + puntata)).toFixed(2);
          } while (profitto < 1 && totale + puntata <= capitale && puntata <= puntataMax);
        }
      }

      document.getElementById("output").value = risultato || "Parametri non validi o capitale troppo basso.";
    }
  </script>
</body>
</html>
